language: r
r: 
  - 4.0.2

before_install:
- sudo mkdir -p /usr/lib/R/library
- echo 'R_LIBS=/usr/lib/R/library:/usr/lib/R/site-library/' > ~/.Renviron
- sudo chmod 2777 /usr/lib/R/library
- sudo add-apt-repository -y ppa:opencpu/jq
- sudo apt-get update
- sudo apt-get install libproj-dev libgdal-dev libv8-3.14-dev libprotobuf-dev protobuf-compiler libjq-dev 

sudo: required

branches:
  only:
  - master

cache:
  directories:
  - $HOME/.local/share/renv
  - $TRAVIS_BUILD_DIR/renv/library

install:
  - Rscript -e "renv::restore()"

deploy:
  provider: script
  script: 
  - R -f deploy.R
